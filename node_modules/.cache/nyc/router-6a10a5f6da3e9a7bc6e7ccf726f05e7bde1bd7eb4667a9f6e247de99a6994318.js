"use strict";function cov_2gx4396ktu(){var path="C:\\Users\\SOA\\Documents\\edward-cursos\\ExpresTypeScript\\js\\routers\\router.js";var hash="9ce8cc2a1741f167f60e5742050db922838a9d5f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\SOA\\Documents\\edward-cursos\\ExpresTypeScript\\js\\routers\\router.js",statementMap:{"0":{start:{line:2,column:22},end:{line:8,column:3}},"1":{start:{line:3,column:4},end:{line:3,column:33}},"2":{start:{line:3,column:26},end:{line:3,column:33}},"3":{start:{line:4,column:4},end:{line:4,column:89}},"4":{start:{line:4,column:71},end:{line:4,column:83}},"5":{start:{line:6,column:4},end:{line:6,column:33}},"6":{start:{line:6,column:26},end:{line:6,column:33}},"7":{start:{line:7,column:4},end:{line:7,column:17}},"8":{start:{line:9,column:25},end:{line:13,column:2}},"9":{start:{line:10,column:4},end:{line:10,column:72}},"10":{start:{line:12,column:4},end:{line:12,column:21}},"11":{start:{line:14,column:19},end:{line:20,column:1}},"12":{start:{line:15,column:4},end:{line:15,column:42}},"13":{start:{line:15,column:31},end:{line:15,column:42}},"14":{start:{line:16,column:17},end:{line:16,column:19}},"15":{start:{line:17,column:4},end:{line:17,column:112}},"16":{start:{line:17,column:21},end:{line:17,column:112}},"17":{start:{line:17,column:40},end:{line:17,column:112}},"18":{start:{line:17,column:80},end:{line:17,column:112}},"19":{start:{line:18,column:4},end:{line:18,column:36}},"20":{start:{line:19,column:4},end:{line:19,column:18}},"21":{start:{line:21,column:0},end:{line:21,column:62}},"22":{start:{line:22,column:16},end:{line:22,column:34}},"23":{start:{line:23,column:13},end:{line:23,column:31}},"24":{start:{line:24,column:9},end:{line:24,column:48}},"25":{start:{line:25,column:10},end:{line:25,column:47}},"26":{start:{line:26,column:12},end:{line:26,column:48}},"27":{start:{line:29,column:21},end:{line:29,column:49}},"28":{start:{line:30,column:4},end:{line:38,column:5}},"29":{start:{line:31,column:26},end:{line:31,column:50}},"30":{start:{line:32,column:8},end:{line:32,column:32}},"31":{start:{line:34,column:8},end:{line:34,column:15}},"32":{start:{line:37,column:8},end:{line:37,column:28}},"33":{start:{line:42,column:13},end:{line:42,column:26}},"34":{start:{line:43,column:4},end:{line:52,column:7}},"35":{start:{line:44,column:8},end:{line:45,column:22}},"36":{start:{line:45,column:12},end:{line:45,column:22}},"37":{start:{line:46,column:8},end:{line:51,column:9}},"38":{start:{line:47,column:12},end:{line:47,column:34}},"39":{start:{line:50,column:12},end:{line:50,column:19}},"40":{start:{line:54,column:0},end:{line:65,column:3}},"41":{start:{line:57,column:17},end:{line:57,column:41}},"42":{start:{line:60,column:4},end:{line:64,column:7}},"43":{start:{line:61,column:8},end:{line:63,column:11}},"44":{start:{line:67,column:0},end:{line:80,column:3}},"45":{start:{line:68,column:4},end:{line:79,column:7}},"46":{start:{line:69,column:8},end:{line:78,column:9}},"47":{start:{line:70,column:12},end:{line:70,column:32}},"48":{start:{line:73,column:12},end:{line:77,column:15}},"49":{start:{line:74,column:16},end:{line:75,column:32}},"50":{start:{line:75,column:20},end:{line:75,column:32}},"51":{start:{line:76,column:16},end:{line:76,column:50}},"52":{start:{line:82,column:0},end:{line:97,column:3}},"53":{start:{line:83,column:4},end:{line:96,column:7}},"54":{start:{line:84,column:8},end:{line:95,column:9}},"55":{start:{line:85,column:12},end:{line:85,column:32}},"56":{start:{line:88,column:21},end:{line:88,column:34}},"57":{start:{line:89,column:12},end:{line:94,column:15}},"58":{start:{line:90,column:16},end:{line:91,column:32}},"59":{start:{line:91,column:20},end:{line:91,column:32}},"60":{start:{line:92,column:16},end:{line:92,column:60}},"61":{start:{line:93,column:16},end:{line:93,column:57}},"62":{start:{line:99,column:0},end:{line:123,column:3}},"63":{start:{line:100,column:4},end:{line:122,column:7}},"64":{start:{line:101,column:8},end:{line:121,column:9}},"65":{start:{line:102,column:12},end:{line:102,column:39}},"66":{start:{line:105,column:26},end:{line:105,column:42}},"67":{start:{line:106,column:26},end:{line:106,column:58}},"68":{start:{line:107,column:30},end:{line:107,column:66}},"69":{start:{line:108,column:26},end:{line:108,column:27}},"70":{start:{line:109,column:12},end:{line:120,column:15}},"71":{start:{line:110,column:16},end:{line:111,column:32}},"72":{start:{line:111,column:20},end:{line:111,column:32}},"73":{start:{line:112,column:30},end:{line:118,column:18}},"74":{start:{line:113,column:20},end:{line:114,column:36}},"75":{start:{line:114,column:24},end:{line:114,column:36}},"76":{start:{line:115,column:34},end:{line:115,column:50}},"77":{start:{line:117,column:20},end:{line:117,column:81}},"78":{start:{line:119,column:16},end:{line:119,column:71}},"79":{start:{line:125,column:0},end:{line:145,column:3}},"80":{start:{line:126,column:4},end:{line:144,column:7}},"81":{start:{line:127,column:8},end:{line:143,column:9}},"82":{start:{line:128,column:12},end:{line:128,column:32}},"83":{start:{line:131,column:23},end:{line:131,column:36}},"84":{start:{line:132,column:26},end:{line:132,column:42}},"85":{start:{line:133,column:26},end:{line:133,column:58}},"86":{start:{line:134,column:30},end:{line:134,column:66}},"87":{start:{line:135,column:26},end:{line:135,column:27}},"88":{start:{line:136,column:12},end:{line:142,column:15}},"89":{start:{line:137,column:16},end:{line:138,column:32}},"90":{start:{line:138,column:20},end:{line:138,column:32}},"91":{start:{line:139,column:16},end:{line:139,column:74}},"92":{start:{line:140,column:16},end:{line:140,column:61}},"93":{start:{line:147,column:0},end:{line:163,column:3}},"94":{start:{line:148,column:4},end:{line:162,column:7}},"95":{start:{line:149,column:8},end:{line:161,column:9}},"96":{start:{line:150,column:12},end:{line:150,column:32}},"97":{start:{line:153,column:23},end:{line:153,column:36}},"98":{start:{line:154,column:12},end:{line:160,column:15}},"99":{start:{line:155,column:16},end:{line:156,column:32}},"100":{start:{line:156,column:20},end:{line:156,column:32}},"101":{start:{line:157,column:16},end:{line:157,column:41}},"102":{start:{line:158,column:16},end:{line:158,column:59}},"103":{start:{line:164,column:0},end:{line:164,column:25}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:2,column:74},end:{line:2,column:75}},loc:{start:{line:2,column:96},end:{line:5,column:1}},line:2},"1":{name:"(anonymous_1)",decl:{start:{line:4,column:58},end:{line:4,column:59}},loc:{start:{line:4,column:69},end:{line:4,column:85}},line:4},"2":{name:"(anonymous_2)",decl:{start:{line:5,column:6},end:{line:5,column:7}},loc:{start:{line:5,column:28},end:{line:8,column:1}},line:5},"3":{name:"(anonymous_3)",decl:{start:{line:9,column:80},end:{line:9,column:81}},loc:{start:{line:9,column:95},end:{line:11,column:1}},line:9},"4":{name:"(anonymous_4)",decl:{start:{line:11,column:5},end:{line:11,column:6}},loc:{start:{line:11,column:20},end:{line:13,column:1}},line:11},"5":{name:"(anonymous_5)",decl:{start:{line:14,column:50},end:{line:14,column:51}},loc:{start:{line:14,column:65},end:{line:20,column:1}},line:14},"6":{name:"verificarToken",decl:{start:{line:28,column:9},end:{line:28,column:23}},loc:{start:{line:28,column:40},end:{line:39,column:1}},line:28},"7":{name:"cache",decl:{start:{line:41,column:9},end:{line:41,column:14}},loc:{start:{line:41,column:31},end:{line:53,column:1}},line:41},"8":{name:"(anonymous_8)",decl:{start:{line:43,column:27},end:{line:43,column:28}},loc:{start:{line:43,column:48},end:{line:52,column:5}},line:43},"9":{name:"(anonymous_9)",decl:{start:{line:54,column:22},end:{line:54,column:23}},loc:{start:{line:54,column:42},end:{line:65,column:1}},line:54},"10":{name:"(anonymous_10)",decl:{start:{line:60,column:46},end:{line:60,column:47}},loc:{start:{line:60,column:68},end:{line:64,column:5}},line:60},"11":{name:"(anonymous_11)",decl:{start:{line:67,column:32},end:{line:67,column:33}},loc:{start:{line:67,column:52},end:{line:80,column:1}},line:67},"12":{name:"(anonymous_12)",decl:{start:{line:68,column:39},end:{line:68,column:40}},loc:{start:{line:68,column:66},end:{line:79,column:5}},line:68},"13":{name:"(anonymous_13)",decl:{start:{line:73,column:54},end:{line:73,column:55}},loc:{start:{line:73,column:79},end:{line:77,column:13}},line:73},"14":{name:"(anonymous_14)",decl:{start:{line:82,column:42},end:{line:82,column:43}},loc:{start:{line:82,column:62},end:{line:97,column:1}},line:82},"15":{name:"(anonymous_15)",decl:{start:{line:83,column:39},end:{line:83,column:40}},loc:{start:{line:83,column:66},end:{line:96,column:5}},line:83},"16":{name:"(anonymous_16)",decl:{start:{line:89,column:74},end:{line:89,column:75}},loc:{start:{line:89,column:99},end:{line:94,column:13}},line:89},"17":{name:"(anonymous_17)",decl:{start:{line:99,column:33},end:{line:99,column:34}},loc:{start:{line:99,column:53},end:{line:123,column:1}},line:99},"18":{name:"(anonymous_18)",decl:{start:{line:100,column:39},end:{line:100,column:40}},loc:{start:{line:100,column:66},end:{line:122,column:5}},line:100},"19":{name:"(anonymous_19)",decl:{start:{line:109,column:165},end:{line:109,column:166}},loc:{start:{line:109,column:190},end:{line:120,column:13}},line:109},"20":{name:"(anonymous_20)",decl:{start:{line:112,column:78},end:{line:112,column:79}},loc:{start:{line:112,column:101},end:{line:118,column:17}},line:112},"21":{name:"(anonymous_21)",decl:{start:{line:125,column:35},end:{line:125,column:36}},loc:{start:{line:125,column:55},end:{line:145,column:1}},line:125},"22":{name:"(anonymous_22)",decl:{start:{line:126,column:39},end:{line:126,column:40}},loc:{start:{line:126,column:66},end:{line:144,column:5}},line:126},"23":{name:"(anonymous_23)",decl:{start:{line:136,column:132},end:{line:136,column:133}},loc:{start:{line:136,column:157},end:{line:142,column:13}},line:136},"24":{name:"(anonymous_24)",decl:{start:{line:147,column:38},end:{line:147,column:39}},loc:{start:{line:147,column:58},end:{line:163,column:1}},line:147},"25":{name:"(anonymous_25)",decl:{start:{line:148,column:39},end:{line:148,column:40}},loc:{start:{line:148,column:66},end:{line:162,column:5}},line:148},"26":{name:"(anonymous_26)",decl:{start:{line:154,column:74},end:{line:154,column:75}},loc:{start:{line:154,column:99},end:{line:160,column:13}},line:154}},branchMap:{"0":{loc:{start:{line:2,column:22},end:{line:8,column:3}},type:"binary-expr",locations:[{start:{line:2,column:23},end:{line:2,column:27}},{start:{line:2,column:31},end:{line:2,column:51}},{start:{line:2,column:57},end:{line:8,column:2}}],line:2},"1":{loc:{start:{line:2,column:57},end:{line:8,column:2}},type:"cond-expr",locations:[{start:{line:2,column:74},end:{line:5,column:1}},{start:{line:5,column:6},end:{line:8,column:1}}],line:2},"2":{loc:{start:{line:3,column:4},end:{line:3,column:33}},type:"if",locations:[{start:{line:3,column:4},end:{line:3,column:33}},{start:{line:3,column:4},end:{line:3,column:33}}],line:3},"3":{loc:{start:{line:6,column:4},end:{line:6,column:33}},type:"if",locations:[{start:{line:6,column:4},end:{line:6,column:33}},{start:{line:6,column:4},end:{line:6,column:33}}],line:6},"4":{loc:{start:{line:9,column:25},end:{line:13,column:2}},type:"binary-expr",locations:[{start:{line:9,column:26},end:{line:9,column:30}},{start:{line:9,column:34},end:{line:9,column:57}},{start:{line:9,column:63},end:{line:13,column:1}}],line:9},"5":{loc:{start:{line:9,column:63},end:{line:13,column:1}},type:"cond-expr",locations:[{start:{line:9,column:80},end:{line:11,column:1}},{start:{line:11,column:5},end:{line:13,column:1}}],line:9},"6":{loc:{start:{line:14,column:19},end:{line:20,column:1}},type:"binary-expr",locations:[{start:{line:14,column:20},end:{line:14,column:24}},{start:{line:14,column:28},end:{line:14,column:45}},{start:{line:14,column:50},end:{line:20,column:1}}],line:14},"7":{loc:{start:{line:15,column:4},end:{line:15,column:42}},type:"if",locations:[{start:{line:15,column:4},end:{line:15,column:42}},{start:{line:15,column:4},end:{line:15,column:42}}],line:15},"8":{loc:{start:{line:15,column:8},end:{line:15,column:29}},type:"binary-expr",locations:[{start:{line:15,column:8},end:{line:15,column:11}},{start:{line:15,column:15},end:{line:15,column:29}}],line:15},"9":{loc:{start:{line:17,column:4},end:{line:17,column:112}},type:"if",locations:[{start:{line:17,column:4},end:{line:17,column:112}},{start:{line:17,column:4},end:{line:17,column:112}}],line:17},"10":{loc:{start:{line:17,column:40},end:{line:17,column:112}},type:"if",locations:[{start:{line:17,column:40},end:{line:17,column:112}},{start:{line:17,column:40},end:{line:17,column:112}}],line:17},"11":{loc:{start:{line:30,column:4},end:{line:38,column:5}},type:"if",locations:[{start:{line:30,column:4},end:{line:38,column:5}},{start:{line:30,column:4},end:{line:38,column:5}}],line:30},"12":{loc:{start:{line:44,column:8},end:{line:45,column:22}},type:"if",locations:[{start:{line:44,column:8},end:{line:45,column:22}},{start:{line:44,column:8},end:{line:45,column:22}}],line:44},"13":{loc:{start:{line:46,column:8},end:{line:51,column:9}},type:"if",locations:[{start:{line:46,column:8},end:{line:51,column:9}},{start:{line:46,column:8},end:{line:51,column:9}}],line:46},"14":{loc:{start:{line:69,column:8},end:{line:78,column:9}},type:"if",locations:[{start:{line:69,column:8},end:{line:78,column:9}},{start:{line:69,column:8},end:{line:78,column:9}}],line:69},"15":{loc:{start:{line:74,column:16},end:{line:75,column:32}},type:"if",locations:[{start:{line:74,column:16},end:{line:75,column:32}},{start:{line:74,column:16},end:{line:75,column:32}}],line:74},"16":{loc:{start:{line:84,column:8},end:{line:95,column:9}},type:"if",locations:[{start:{line:84,column:8},end:{line:95,column:9}},{start:{line:84,column:8},end:{line:95,column:9}}],line:84},"17":{loc:{start:{line:90,column:16},end:{line:91,column:32}},type:"if",locations:[{start:{line:90,column:16},end:{line:91,column:32}},{start:{line:90,column:16},end:{line:91,column:32}}],line:90},"18":{loc:{start:{line:101,column:8},end:{line:121,column:9}},type:"if",locations:[{start:{line:101,column:8},end:{line:121,column:9}},{start:{line:101,column:8},end:{line:121,column:9}}],line:101},"19":{loc:{start:{line:110,column:16},end:{line:111,column:32}},type:"if",locations:[{start:{line:110,column:16},end:{line:111,column:32}},{start:{line:110,column:16},end:{line:111,column:32}}],line:110},"20":{loc:{start:{line:113,column:20},end:{line:114,column:36}},type:"if",locations:[{start:{line:113,column:20},end:{line:114,column:36}},{start:{line:113,column:20},end:{line:114,column:36}}],line:113},"21":{loc:{start:{line:127,column:8},end:{line:143,column:9}},type:"if",locations:[{start:{line:127,column:8},end:{line:143,column:9}},{start:{line:127,column:8},end:{line:143,column:9}}],line:127},"22":{loc:{start:{line:137,column:16},end:{line:138,column:32}},type:"if",locations:[{start:{line:137,column:16},end:{line:138,column:32}},{start:{line:137,column:16},end:{line:138,column:32}}],line:137},"23":{loc:{start:{line:149,column:8},end:{line:161,column:9}},type:"if",locations:[{start:{line:149,column:8},end:{line:161,column:9}},{start:{line:149,column:8},end:{line:161,column:9}}],line:149},"24":{loc:{start:{line:155,column:16},end:{line:156,column:32}},type:"if",locations:[{start:{line:155,column:16},end:{line:156,column:32}},{start:{line:155,column:16},end:{line:156,column:32}}],line:155}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"9ce8cc2a1741f167f60e5742050db922838a9d5f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2gx4396ktu=function(){return actualCoverage;};}return actualCoverage;}cov_2gx4396ktu();var __createBinding=(cov_2gx4396ktu().s[0]++,(cov_2gx4396ktu().b[0][0]++,this)&&(cov_2gx4396ktu().b[0][1]++,this.__createBinding)||(cov_2gx4396ktu().b[0][2]++,Object.create?(cov_2gx4396ktu().b[1][0]++,function(o,m,k,k2){cov_2gx4396ktu().f[0]++;cov_2gx4396ktu().s[1]++;if(k2===undefined){cov_2gx4396ktu().b[2][0]++;cov_2gx4396ktu().s[2]++;k2=k;}else{cov_2gx4396ktu().b[2][1]++;}cov_2gx4396ktu().s[3]++;Object.defineProperty(o,k2,{enumerable:true,get:function(){cov_2gx4396ktu().f[1]++;cov_2gx4396ktu().s[4]++;return m[k];}});}):(cov_2gx4396ktu().b[1][1]++,function(o,m,k,k2){cov_2gx4396ktu().f[2]++;cov_2gx4396ktu().s[5]++;if(k2===undefined){cov_2gx4396ktu().b[3][0]++;cov_2gx4396ktu().s[6]++;k2=k;}else{cov_2gx4396ktu().b[3][1]++;}cov_2gx4396ktu().s[7]++;o[k2]=m[k];})));var __setModuleDefault=(cov_2gx4396ktu().s[8]++,(cov_2gx4396ktu().b[4][0]++,this)&&(cov_2gx4396ktu().b[4][1]++,this.__setModuleDefault)||(cov_2gx4396ktu().b[4][2]++,Object.create?(cov_2gx4396ktu().b[5][0]++,function(o,v){cov_2gx4396ktu().f[3]++;cov_2gx4396ktu().s[9]++;Object.defineProperty(o,"default",{enumerable:true,value:v});}):(cov_2gx4396ktu().b[5][1]++,function(o,v){cov_2gx4396ktu().f[4]++;cov_2gx4396ktu().s[10]++;o["default"]=v;})));var __importStar=(cov_2gx4396ktu().s[11]++,(cov_2gx4396ktu().b[6][0]++,this)&&(cov_2gx4396ktu().b[6][1]++,this.__importStar)||(cov_2gx4396ktu().b[6][2]++,function(mod){cov_2gx4396ktu().f[5]++;cov_2gx4396ktu().s[12]++;if((cov_2gx4396ktu().b[8][0]++,mod)&&(cov_2gx4396ktu().b[8][1]++,mod.__esModule)){cov_2gx4396ktu().b[7][0]++;cov_2gx4396ktu().s[13]++;return mod;}else{cov_2gx4396ktu().b[7][1]++;}var result=(cov_2gx4396ktu().s[14]++,{});cov_2gx4396ktu().s[15]++;if(mod!=null){cov_2gx4396ktu().b[9][0]++;cov_2gx4396ktu().s[16]++;for(var k in mod){cov_2gx4396ktu().s[17]++;if(Object.hasOwnProperty.call(mod,k)){cov_2gx4396ktu().b[10][0]++;cov_2gx4396ktu().s[18]++;__createBinding(result,mod,k);}else{cov_2gx4396ktu().b[10][1]++;}}}else{cov_2gx4396ktu().b[9][1]++;}cov_2gx4396ktu().s[19]++;__setModuleDefault(result,mod);cov_2gx4396ktu().s[20]++;return result;}));cov_2gx4396ktu().s[21]++;Object.defineProperty(exports,"__esModule",{value:true});var express_1=(cov_2gx4396ktu().s[22]++,require("express"));var router=(cov_2gx4396ktu().s[23]++,express_1.Router());var db=(cov_2gx4396ktu().s[24]++,__importStar(require("../bd/conexion")));var jwt=(cov_2gx4396ktu().s[25]++,__importStar(require("jsonwebtoken")));var redis=(cov_2gx4396ktu().s[26]++,__importStar(require("../bd/redis")));//Verificacion de token
function verificarToken(req,res,next){cov_2gx4396ktu().f[6]++;var encabezado=(cov_2gx4396ktu().s[27]++,req.headers['authorization']);cov_2gx4396ktu().s[28]++;if(typeof encabezado!=='undefined'){cov_2gx4396ktu().b[11][0]++;var bearerToken=(cov_2gx4396ktu().s[29]++,encabezado.split(" ")[1]);cov_2gx4396ktu().s[30]++;req.token=bearerToken;//req.token = "foobar";
cov_2gx4396ktu().s[31]++;next();}else{cov_2gx4396ktu().b[11][1]++;cov_2gx4396ktu().s[32]++;res.sendStatus(403);}}//Funcion middleware para el almacenamiento en cachÃ© de datos.
function cache(req,res,next){cov_2gx4396ktu().f[7]++;var id=(cov_2gx4396ktu().s[33]++,req.params.id);cov_2gx4396ktu().s[34]++;redis.conexion.get(id,function(err,data){cov_2gx4396ktu().f[8]++;cov_2gx4396ktu().s[35]++;if(err){cov_2gx4396ktu().b[12][0]++;cov_2gx4396ktu().s[36]++;throw err;}else{cov_2gx4396ktu().b[12][1]++;}cov_2gx4396ktu().s[37]++;if(data!==null){cov_2gx4396ktu().b[13][0]++;cov_2gx4396ktu().s[38]++;return res.send(data);}else{cov_2gx4396ktu().b[13][1]++;cov_2gx4396ktu().s[39]++;next();}});}cov_2gx4396ktu().s[40]++;router.post('/login',function(req,res){cov_2gx4396ktu().f[9]++;//const user = {
//nombre: "parangaracutirimicuaro"
var nombre=(cov_2gx4396ktu().s[41]++,"parangaracutirimicuaro");//}
//jwt.sign({user}, 'secretkey', (err:Error,token:any)=>{
cov_2gx4396ktu().s[42]++;jwt.sign({nombre:nombre},'secretkey',function(err,token){cov_2gx4396ktu().f[10]++;cov_2gx4396ktu().s[43]++;res.json({token:token});});});//Obtener todos los usuarios
cov_2gx4396ktu().s[44]++;router.get('/',verificarToken,function(req,res){cov_2gx4396ktu().f[11]++;cov_2gx4396ktu().s[45]++;jwt.verify(req.token,'secretkey',function(error,authData){cov_2gx4396ktu().f[12]++;cov_2gx4396ktu().s[46]++;if(error){cov_2gx4396ktu().b[14][0]++;cov_2gx4396ktu().s[47]++;res.sendStatus(403);}else{cov_2gx4396ktu().b[14][1]++;cov_2gx4396ktu().s[48]++;db.client.query('SELECT * FROM usuarios',function(error,result){cov_2gx4396ktu().f[13]++;cov_2gx4396ktu().s[49]++;if(error){cov_2gx4396ktu().b[15][0]++;cov_2gx4396ktu().s[50]++;throw error;}else{cov_2gx4396ktu().b[15][1]++;}cov_2gx4396ktu().s[51]++;res.status(200).send(result.rows);});}});});//Mostrar un usuario por su id
cov_2gx4396ktu().s[52]++;router.get('/:id',verificarToken,cache,function(req,res){cov_2gx4396ktu().f[14]++;cov_2gx4396ktu().s[53]++;jwt.verify(req.token,'secretkey',function(error,authData){cov_2gx4396ktu().f[15]++;cov_2gx4396ktu().s[54]++;if(error){cov_2gx4396ktu().b[16][0]++;cov_2gx4396ktu().s[55]++;res.sendStatus(403);}else{cov_2gx4396ktu().b[16][1]++;var id=(cov_2gx4396ktu().s[56]++,req.params.id);cov_2gx4396ktu().s[57]++;db.client.query('SELECT * FROM usuarios WHERE id = $1',[id],function(error,result){cov_2gx4396ktu().f[16]++;cov_2gx4396ktu().s[58]++;if(error){cov_2gx4396ktu().b[17][0]++;cov_2gx4396ktu().s[59]++;throw error;}else{cov_2gx4396ktu().b[17][1]++;}cov_2gx4396ktu().s[60]++;console.log("Resultado traido de postgres");cov_2gx4396ktu().s[61]++;return res.status(200).send(result.rows);});}});});// Agregar un nuevo usuario
cov_2gx4396ktu().s[62]++;router.post('/',verificarToken,function(req,res){cov_2gx4396ktu().f[17]++;cov_2gx4396ktu().s[63]++;jwt.verify(req.token,'secretkey',function(error,authData){cov_2gx4396ktu().f[18]++;cov_2gx4396ktu().s[64]++;if(error){cov_2gx4396ktu().b[18][0]++;cov_2gx4396ktu().s[65]++;return res.sendStatus(403);}else{cov_2gx4396ktu().b[18][1]++;var usuario=(cov_2gx4396ktu().s[66]++,req.body.usuario);var persona=(cov_2gx4396ktu().s[67]++,JSON.stringify(req.body.persona));var habilidades=(cov_2gx4396ktu().s[68]++,JSON.stringify(req.body.habilidades));var version=(cov_2gx4396ktu().s[69]++,1);cov_2gx4396ktu().s[70]++;db.client.query('INSERT INTO USUARIOS (USUARIO,PERSONA,HABILIDADES,VERSION) VALUES($1,$2,$3,$4) RETURNING ID',[usuario,persona,habilidades,version],function(error,result){cov_2gx4396ktu().f[19]++;cov_2gx4396ktu().s[71]++;if(error){cov_2gx4396ktu().b[19][0]++;cov_2gx4396ktu().s[72]++;throw error;}else{cov_2gx4396ktu().b[19][1]++;}var nuevoID=(cov_2gx4396ktu().s[73]++,db.client.query('SELECT MAX(id) FROM USUARIOS',function(error,rows){cov_2gx4396ktu().f[20]++;cov_2gx4396ktu().s[74]++;if(error){cov_2gx4396ktu().b[20][0]++;cov_2gx4396ktu().s[75]++;throw error;}else{cov_2gx4396ktu().b[20][1]++;}var nuevoID=(cov_2gx4396ktu().s[76]++,rows.rows[0].max);//console.log(nuevoID);
cov_2gx4396ktu().s[77]++;redis.conexion.setex(nuevoID,300,JSON.stringify(req.body));}));cov_2gx4396ktu().s[78]++;res.status(200).send("Usuario agregado correctamente");});}});});//Actualizar un usuario
cov_2gx4396ktu().s[79]++;router.put('/:id',verificarToken,function(req,res){cov_2gx4396ktu().f[21]++;cov_2gx4396ktu().s[80]++;jwt.verify(req.token,'secretkey',function(error,authData){cov_2gx4396ktu().f[22]++;cov_2gx4396ktu().s[81]++;if(error){cov_2gx4396ktu().b[21][0]++;cov_2gx4396ktu().s[82]++;res.sendStatus(403);}else{cov_2gx4396ktu().b[21][1]++;var id_1=(cov_2gx4396ktu().s[83]++,req.params.id);var usuario=(cov_2gx4396ktu().s[84]++,req.body.usuario);var persona=(cov_2gx4396ktu().s[85]++,JSON.stringify(req.body.persona));var habilidades=(cov_2gx4396ktu().s[86]++,JSON.stringify(req.body.habilidades));var version=(cov_2gx4396ktu().s[87]++,2);cov_2gx4396ktu().s[88]++;db.client.query('UPDATE usuarios SET usuario=$1,persona=$2,version=$3 WHERE id =$4',[usuario,persona,version,id_1],function(error,result){cov_2gx4396ktu().f[23]++;cov_2gx4396ktu().s[89]++;if(error){cov_2gx4396ktu().b[22][0]++;cov_2gx4396ktu().s[90]++;throw error;}else{cov_2gx4396ktu().b[22][1]++;}cov_2gx4396ktu().s[91]++;redis.conexion.setex(id_1,300,JSON.stringify(req.body));cov_2gx4396ktu().s[92]++;res.status(200).send('Usuario actualizado.');//return res.json(result.rows[0]);
});}});});//Eliminar un usuario
cov_2gx4396ktu().s[93]++;router.delete('/:id',verificarToken,function(req,res){cov_2gx4396ktu().f[24]++;cov_2gx4396ktu().s[94]++;jwt.verify(req.token,'secretkey',function(error,authData){cov_2gx4396ktu().f[25]++;cov_2gx4396ktu().s[95]++;if(error){cov_2gx4396ktu().b[23][0]++;cov_2gx4396ktu().s[96]++;res.sendStatus(403);}else{cov_2gx4396ktu().b[23][1]++;var id_2=(cov_2gx4396ktu().s[97]++,req.params.id);cov_2gx4396ktu().s[98]++;db.client.query('DELETE FROM usuarios WHERE id = $1',[id_2],function(error,result){cov_2gx4396ktu().f[26]++;cov_2gx4396ktu().s[99]++;if(error){cov_2gx4396ktu().b[24][0]++;cov_2gx4396ktu().s[100]++;throw error;}else{cov_2gx4396ktu().b[24][1]++;}cov_2gx4396ktu().s[101]++;redis.conexion.del(id_2);cov_2gx4396ktu().s[102]++;res.status(200).send('Usuario eliminado.');//return res.json(result.rows[0]);
});}});});cov_2gx4396ktu().s[103]++;exports.default=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlci5qcyJdLCJuYW1lcyI6WyJfX2NyZWF0ZUJpbmRpbmciLCJPYmplY3QiLCJjcmVhdGUiLCJvIiwibSIsImsiLCJrMiIsInVuZGVmaW5lZCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIl9fc2V0TW9kdWxlRGVmYXVsdCIsInYiLCJ2YWx1ZSIsIl9faW1wb3J0U3RhciIsIm1vZCIsIl9fZXNNb2R1bGUiLCJyZXN1bHQiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJleHBvcnRzIiwiZXhwcmVzc18xIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImRiIiwiand0IiwicmVkaXMiLCJ2ZXJpZmljYXJUb2tlbiIsInJlcSIsInJlcyIsIm5leHQiLCJlbmNhYmV6YWRvIiwiaGVhZGVycyIsImJlYXJlclRva2VuIiwic3BsaXQiLCJ0b2tlbiIsInNlbmRTdGF0dXMiLCJjYWNoZSIsImlkIiwicGFyYW1zIiwiY29uZXhpb24iLCJlcnIiLCJkYXRhIiwic2VuZCIsInBvc3QiLCJub21icmUiLCJzaWduIiwianNvbiIsInZlcmlmeSIsImVycm9yIiwiYXV0aERhdGEiLCJjbGllbnQiLCJxdWVyeSIsInN0YXR1cyIsInJvd3MiLCJjb25zb2xlIiwibG9nIiwidXN1YXJpbyIsImJvZHkiLCJwZXJzb25hIiwiSlNPTiIsInN0cmluZ2lmeSIsImhhYmlsaWRhZGVzIiwidmVyc2lvbiIsIm51ZXZvSUQiLCJtYXgiLCJzZXRleCIsInB1dCIsImlkXzEiLCJkZWxldGUiLCJpZF8yIiwiZGVsIiwiZGVmYXVsdCJdLCJtYXBwaW5ncyI6IkFBQUEsYSxtOWdCQWVZOzJGQWRaLEdBQUlBLENBQUFBLGVBQWUsMEJBQUksK0RBQVEsS0FBS0EsZUFBYixDQUFELDhCQUFtQ0MsTUFBTSxDQUFDQyxNQUFQLDZCQUFpQixTQUFTQyxDQUFULENBQVlDLENBQVosQ0FBZUMsQ0FBZixDQUFrQkMsRUFBbEIsQ0FBc0IsaURBQzVGLEdBQUlBLEVBQUUsR0FB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QkgsQ0FwQkQsRUFxQkE7eUJBQ0FyQixNQUFNLENBQUMrQyxNQUFQLENBQWMsTUFBZCxDQUFzQjFDLGNBQXRCLENBQXNDLFNBQVVDLEdBQVYsQ0FBZUMsR0FBZixDQUFvQixtREFDdERKLEdBQUcsQ0FBQ3VCLE1BQUosQ0FBV3BCLEdBQUcsQ0FBQ08sS0FBZixDQUFzQixXQUF0QixDQUFtQyxTQUFVYyxLQUFWLENBQWlCQyxRQUFqQixDQUEyQixtREFDMUQsR0FBSUQsS0FBSixDQUFXLHNEQUNQcEIsR0FBRyxDQUFDTyxVQUFKLENBQWUsR0FBZixFQUNILENBRkQsSUFHSyw2QkFDRCxHQUFJa0MsQ0FBQUEsSUFBSSwyQkFBRzFDLEdBQUcsQ0FBQ1csTUFBSixDQUFXRCxFQUFkLENBQVIsQ0FEQyx5QkFFRGQsRUFBRSxDQUFDMkIsTUFBSCxDQUFVQyxLQUFWLENBQWdCLG9DQUFoQixDQUFzRCxDQUFDa0IsSUFBRCxDQUF0RCxDQUE4RCxTQUFVckIsS0FBVixDQUFpQmpDLE1BQWpCLENBQXlCLG1EQUNuRixHQUFJaUMsS0FBSixDQUNJLDREQUFNQSxDQUFBQSxLQUFOLENBQVksQ0FEaEIsa0NBRG1GLDBCQUduRnZCLEtBQUssQ0FBQ2MsUUFBTixDQUFlK0IsR0FBZixDQUFtQkQsSUFBbkIsRUFIbUYsMEJBSW5GekMsR0FBRyxDQUFDd0IsTUFBSixDQUFXLEdBQVgsRUFBZ0JWLElBQWhCLENBQXFCLG9CQUFyQixFQUNBO0FBQ0gsQ0FORCxFQU9ILENBQ0osQ0FkRCxFQWVILENBaEJELEUsMEJBaUJBeEIsT0FBTyxDQUFDcUQsT0FBUixDQUFrQmxELE1BQWxCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KSk7XHJcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSAodGhpcyAmJiB0aGlzLl9fc2V0TW9kdWxlRGVmYXVsdCkgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufSk7XHJcbnZhciBfX2ltcG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9faW1wb3J0U3RhcikgfHwgZnVuY3Rpb24gKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxudmFyIGV4cHJlc3NfMSA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xyXG52YXIgcm91dGVyID0gZXhwcmVzc18xLlJvdXRlcigpO1xyXG52YXIgZGIgPSBfX2ltcG9ydFN0YXIocmVxdWlyZShcIi4uL2JkL2NvbmV4aW9uXCIpKTtcclxudmFyIGp3dCA9IF9faW1wb3J0U3RhcihyZXF1aXJlKFwianNvbndlYnRva2VuXCIpKTtcclxudmFyIHJlZGlzID0gX19pbXBvcnRTdGFyKHJlcXVpcmUoXCIuLi9iZC9yZWRpc1wiKSk7XHJcbi8vVmVyaWZpY2FjaW9uIGRlIHRva2VuXHJcbmZ1bmN0aW9uIHZlcmlmaWNhclRva2VuKHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgICB2YXIgZW5jYWJlemFkbyA9IHJlcS5oZWFkZXJzWydhdXRob3JpemF0aW9uJ107XHJcbiAgICBpZiAodHlwZW9mIGVuY2FiZXphZG8gIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgdmFyIGJlYXJlclRva2VuID0gZW5jYWJlemFkby5zcGxpdChcIiBcIilbMV07XHJcbiAgICAgICAgcmVxLnRva2VuID0gYmVhcmVyVG9rZW47XHJcbiAgICAgICAgLy9yZXEudG9rZW4gPSBcImZvb2JhclwiO1xyXG4gICAgICAgIG5leHQoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICB9XHJcbn1cclxuLy9GdW5jaW9uIG1pZGRsZXdhcmUgcGFyYSBlbCBhbG1hY2VuYW1pZW50byBlbiBjYWNow6kgZGUgZGF0b3MuXHJcbmZ1bmN0aW9uIGNhY2hlKHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgICB2YXIgaWQgPSByZXEucGFyYW1zLmlkO1xyXG4gICAgcmVkaXMuY29uZXhpb24uZ2V0KGlkLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XHJcbiAgICAgICAgaWYgKGVycilcclxuICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgIGlmIChkYXRhICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc2VuZChkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG5leHQoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5yb3V0ZXIucG9zdCgnL2xvZ2luJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcbiAgICAvL2NvbnN0IHVzZXIgPSB7XHJcbiAgICAvL25vbWJyZTogXCJwYXJhbmdhcmFjdXRpcmltaWN1YXJvXCJcclxuICAgIHZhciBub21icmUgPSBcInBhcmFuZ2FyYWN1dGlyaW1pY3Vhcm9cIjtcclxuICAgIC8vfVxyXG4gICAgLy9qd3Quc2lnbih7dXNlcn0sICdzZWNyZXRrZXknLCAoZXJyOkVycm9yLHRva2VuOmFueSk9PntcclxuICAgIGp3dC5zaWduKHsgbm9tYnJlOiBub21icmUgfSwgJ3NlY3JldGtleScsIGZ1bmN0aW9uIChlcnIsIHRva2VuKSB7XHJcbiAgICAgICAgcmVzLmpzb24oe1xyXG4gICAgICAgICAgICB0b2tlbjogdG9rZW5cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTtcclxuLy9PYnRlbmVyIHRvZG9zIGxvcyB1c3Vhcmlvc1xyXG5yb3V0ZXIuZ2V0KCcvJywgdmVyaWZpY2FyVG9rZW4sIGZ1bmN0aW9uIChyZXEsIHJlcykge1xyXG4gICAgand0LnZlcmlmeShyZXEudG9rZW4sICdzZWNyZXRrZXknLCBmdW5jdGlvbiAoZXJyb3IsIGF1dGhEYXRhKSB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkYi5jbGllbnQucXVlcnkoJ1NFTEVDVCAqIEZST00gdXN1YXJpb3MnLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQocmVzdWx0LnJvd3MpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSk7XHJcbi8vTW9zdHJhciB1biB1c3VhcmlvIHBvciBzdSBpZFxyXG5yb3V0ZXIuZ2V0KCcvOmlkJywgdmVyaWZpY2FyVG9rZW4sIGNhY2hlLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuICAgIGp3dC52ZXJpZnkocmVxLnRva2VuLCAnc2VjcmV0a2V5JywgZnVuY3Rpb24gKGVycm9yLCBhdXRoRGF0YSkge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGlkID0gcmVxLnBhcmFtcy5pZDtcclxuICAgICAgICAgICAgZGIuY2xpZW50LnF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHVzdWFyaW9zIFdIRVJFIGlkID0gJDEnLCBbaWRdLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXN1bHRhZG8gdHJhaWRvIGRlIHBvc3RncmVzXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHJlc3VsdC5yb3dzKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pO1xyXG4vLyBBZ3JlZ2FyIHVuIG51ZXZvIHVzdWFyaW9cclxucm91dGVyLnBvc3QoJy8nLCB2ZXJpZmljYXJUb2tlbiwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcbiAgICBqd3QudmVyaWZ5KHJlcS50b2tlbiwgJ3NlY3JldGtleScsIGZ1bmN0aW9uIChlcnJvciwgYXV0aERhdGEpIHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdXN1YXJpbyA9IHJlcS5ib2R5LnVzdWFyaW87XHJcbiAgICAgICAgICAgIHZhciBwZXJzb25hID0gSlNPTi5zdHJpbmdpZnkocmVxLmJvZHkucGVyc29uYSk7XHJcbiAgICAgICAgICAgIHZhciBoYWJpbGlkYWRlcyA9IEpTT04uc3RyaW5naWZ5KHJlcS5ib2R5LmhhYmlsaWRhZGVzKTtcclxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSAxO1xyXG4gICAgICAgICAgICBkYi5jbGllbnQucXVlcnkoJ0lOU0VSVCBJTlRPIFVTVUFSSU9TIChVU1VBUklPLFBFUlNPTkEsSEFCSUxJREFERVMsVkVSU0lPTikgVkFMVUVTKCQxLCQyLCQzLCQ0KSBSRVRVUk5JTkcgSUQnLCBbdXN1YXJpbywgcGVyc29uYSwgaGFiaWxpZGFkZXMsIHZlcnNpb25dLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgdmFyIG51ZXZvSUQgPSBkYi5jbGllbnQucXVlcnkoJ1NFTEVDVCBNQVgoaWQpIEZST00gVVNVQVJJT1MnLCBmdW5jdGlvbiAoZXJyb3IsIHJvd3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBudWV2b0lEID0gcm93cy5yb3dzWzBdLm1heDtcclxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKG51ZXZvSUQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlZGlzLmNvbmV4aW9uLnNldGV4KG51ZXZvSUQsIDMwMCwgSlNPTi5zdHJpbmdpZnkocmVxLmJvZHkpKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoXCJVc3VhcmlvIGFncmVnYWRvIGNvcnJlY3RhbWVudGVcIik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTtcclxuLy9BY3R1YWxpemFyIHVuIHVzdWFyaW9cclxucm91dGVyLnB1dCgnLzppZCcsIHZlcmlmaWNhclRva2VuLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuICAgIGp3dC52ZXJpZnkocmVxLnRva2VuLCAnc2VjcmV0a2V5JywgZnVuY3Rpb24gKGVycm9yLCBhdXRoRGF0YSkge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXMuc2VuZFN0YXR1cyg0MDMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGlkXzEgPSByZXEucGFyYW1zLmlkO1xyXG4gICAgICAgICAgICB2YXIgdXN1YXJpbyA9IHJlcS5ib2R5LnVzdWFyaW87XHJcbiAgICAgICAgICAgIHZhciBwZXJzb25hID0gSlNPTi5zdHJpbmdpZnkocmVxLmJvZHkucGVyc29uYSk7XHJcbiAgICAgICAgICAgIHZhciBoYWJpbGlkYWRlcyA9IEpTT04uc3RyaW5naWZ5KHJlcS5ib2R5LmhhYmlsaWRhZGVzKTtcclxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSAyO1xyXG4gICAgICAgICAgICBkYi5jbGllbnQucXVlcnkoJ1VQREFURSB1c3VhcmlvcyBTRVQgdXN1YXJpbz0kMSxwZXJzb25hPSQyLHZlcnNpb249JDMgV0hFUkUgaWQgPSQ0JywgW3VzdWFyaW8sIHBlcnNvbmEsIHZlcnNpb24sIGlkXzFdLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgcmVkaXMuY29uZXhpb24uc2V0ZXgoaWRfMSwgMzAwLCBKU09OLnN0cmluZ2lmeShyZXEuYm9keSkpO1xyXG4gICAgICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoJ1VzdWFyaW8gYWN0dWFsaXphZG8uJyk7XHJcbiAgICAgICAgICAgICAgICAvL3JldHVybiByZXMuanNvbihyZXN1bHQucm93c1swXSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTtcclxuLy9FbGltaW5hciB1biB1c3VhcmlvXHJcbnJvdXRlci5kZWxldGUoJy86aWQnLCB2ZXJpZmljYXJUb2tlbiwgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcbiAgICBqd3QudmVyaWZ5KHJlcS50b2tlbiwgJ3NlY3JldGtleScsIGZ1bmN0aW9uIChlcnJvciwgYXV0aERhdGEpIHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmVzLnNlbmRTdGF0dXMoNDAzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBpZF8yID0gcmVxLnBhcmFtcy5pZDtcclxuICAgICAgICAgICAgZGIuY2xpZW50LnF1ZXJ5KCdERUxFVEUgRlJPTSB1c3VhcmlvcyBXSEVSRSBpZCA9ICQxJywgW2lkXzJdLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgcmVkaXMuY29uZXhpb24uZGVsKGlkXzIpO1xyXG4gICAgICAgICAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQoJ1VzdWFyaW8gZWxpbWluYWRvLicpO1xyXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gcmVzLmpzb24ocmVzdWx0LnJvd3NbMF0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IHJvdXRlcjtcclxuIl19